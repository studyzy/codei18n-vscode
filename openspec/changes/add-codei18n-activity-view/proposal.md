# 变更提案：新增 CodeI18n 侧边栏视图与本地化模式操作

## 背景与动机
当前 CodeI18n VSCode 扩展仅通过装饰和悬停在编辑器中“显示本地化”的注释翻译能力，缺少一个集中入口来：
- 发现与管理 CodeI18n 的配置与功能；
- 初始化当前项目的 CodeI18n 配置；
- 明确区分“仅显示本地化”（无损）与“真正修改源码注释”的文件内容本地化能力；
- 在需要时，将源码注释从中文恢复为英文（“英文化”）。

用户希望在 VSCode 左侧活动栏新增一个 CodeI18n 图标，点击后打开一个专用的 CodeI18n 视图，作为上述操作的统一界面。

## 目标
- 在 VSCode 活动栏添加一个 CodeI18n 图标和视图容器，点击后在侧边栏显示 CodeI18n 操作界面。
- 在该侧边栏视图中提供：
  - “初始化本项目”的入口，用于在当前工作区内执行 CodeI18n 的初始化步骤（例如生成配置文件）。
  - “源码本地化方式”配置入口，明确区分：
    - **显示本地化**：沿用当前行为，仅通过装饰在注释位置显示翻译，不改动文件内容。
    - **文件内容本地化**：通过调用 `codei18n convert -to zh-CN -d .` 等命令真正修改源码中的注释文本。
  - “英文化”操作入口，用于将源码注释恢复为英文（与文件内容本地化形成可逆操作，尽可能依赖 codei18n 提供的能力，而不是自行维护映射）。
- 为上述操作设计清晰的用户交互和安全保护（例如明显的确认提示、进度反馈），避免用户误触导致不可预期的大范围修改。

## 非目标
- 不在本次变更中重新设计或替换现有的注释扫描与装饰实现。
- 不在本次变更中引入复杂的可视化 UI 框架（如完整 Webview 应用），而是优先使用 VS Code 提供的简单视图能力（如 TreeView + 命令）。
- 不在本次变更中实现细粒度的“局部文件/选中文件夹本地化”策略，初始版本以“整个工作区”为主要操作范围（可在后续增量中扩展）。

## 高层方案概述
- 在 `package.json` 中声明一个新的视图容器和视图（Activity Bar 图标 + 侧边栏视图），标识为 `codei18n`。
- 在 `src/extension.ts` 中注册一个新的视图提供者（优先选用简单的 TreeView 结构），在视图中展示若干可点击的操作节点：
  - “初始化本项目”
  - “显示本地化（当前模式标记）”
  - “文件内容本地化”
  - “英文化（恢复英文注释）”
- 为“源码本地化方式”维护一个 VS Code 配置项或内存状态，并在视图中体现当前模式；切换模式时更新配置并通过信息提示说明含义和风险。
- 在 CLI 层面扩展 `CliWrapper` 或新增专门的服务，封装 `codei18n convert ...` 调用逻辑，包括：
  - 使用工作区根目录作为 `cwd`；
  - 提供本地化（中文）和英文化（英文）两种方向；
  - 处理执行过程中的错误与输出，并在 VS Code 中展示结果。
- 所有会修改源码的操作前，弹出确认对话框提醒用户，明确提示操作将会批量改写注释，并建议在执行前做好版本控制（例如 git commit）。

## 关键权衡
- **简化 UI vs. 操作可发现性**：本次变更优先采用 TreeView + 命令的方式实现 CodeI18n 视图，避免引入复杂 Webview；如果后续需要更丰富的交互，可以在未来增量中迭代为 Webview。
- **全局操作 vs. 细粒度控制**：初版提供以当前工作区为范围的转换操作，保证实现简单可用；未来可通过新增规格增量再细化到“当前文件/选定目录”等。
- **安全性 vs. 便捷性**：对于真正修改源码的操作（文件内容本地化与英文化），必须有清晰的确认和反馈，避免用户误触；同时保持操作入口集中在侧边栏，降低误操作概率。